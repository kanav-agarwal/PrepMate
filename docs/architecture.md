# CoachK – SAT Math Tutor Architecture

## Overview
CoachK is a retrieval-augmented SAT Math tutoring system that combines:
- **Item Bank**: curated SAT-style problems with solutions (`data/item_bank.json`).
- **Vector Retrieval**: semantic search using FAISS + SentenceTransformers.
- **LLM Reasoning**: multi-level explanations generated by an LLM.
- **Error Diagnosis**: rule-based + (future) classifier for misconceptions.
- **Adaptive Engine**: mastery-based problem recommendation.

## Components

### 1. Data Layer
- `item_bank.json`: 20+ SAT-style math problems.
- `sample_problems.csv`: minimal CSV for quick demos.
- Embedding index built by `embed_index.py` → `faiss.index`.

### 2. Retrieval Layer
- `retrieve_and_prompt.py`: retrieves top-k problems similar to a query and builds a JSON-output prompt.

### 3. LLM Layer
- `llm_client.py`: modular client to call Hugging Face Inference API (or swap with local LLM).
- Ensures structured JSON responses with keys: `short_answer`, `step_by_step`, `analogy`, `common_errors`.

### 4. Error Classifier
- `error_classifier.py`: MVP rule-based classifier (arithmetic, algebra, form mismatch).
- Future: extend with supervised ML.

### 5. Adaptive Engine
- `adaptive_engine.py`: lightweight recommender.
- Chooses practice problems from weak mastery areas.

### 6. Backend
- `backend/app.py`: FastAPI service exposing:
  - `/query` → tutor explanation + optional error diagnosis.
  - `/practice` → 5 practice problems.

### 7. Frontend
- `frontend/streamlit_app.py`: simple chat-style UI for students.
- Provides explanations, analogies, and practice sets.

## Deployment
- Run locally with Streamlit + FastAPI.
- Future hosting on Hugging Face Spaces / Render / Fly.io.

## Future Enhancements
- Add OCR-based scratchpad input for handwritten math.
- Replace error classifier with ML model.
- Track student mastery persistently (SQLite/Firestore).
- Gamify adaptive engine with streaks, badges, and peer challenge.
